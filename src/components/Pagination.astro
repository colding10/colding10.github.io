---
import { Icon } from 'astro-icon/components'

interface Props {
	currentPage: number
	totalPages: number
	baseUrl: string
}

const { currentPage, totalPages, baseUrl } = Astro.props

const pages = Array.from({ length: totalPages }, (_, i) => i + 1)

function getPageUrl(page: number): string {
	if (page === 1) return baseUrl
	return `${baseUrl}${page}`
}

const hasPrev = currentPage > 1
const hasNext = currentPage < totalPages
---

<nav
	role="navigation"
	aria-label="pagination"
	class="mx-auto flex w-full justify-center"
>
	<ul class="flex flex-row flex-wrap items-center gap-1">
		<li>
			<a
				href={hasPrev ? getPageUrl(currentPage - 1) : undefined}
				aria-label="Go to previous page"
				class:list={[
					'inline-flex h-9 items-center justify-center gap-1 whitespace-nowrap rounded-md px-2.5 text-sm font-medium transition-all hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 sm:pl-2.5',
					!hasPrev && 'pointer-events-none opacity-50',
				]}
			>
				<Icon name="lucide:chevron-left" class="size-4" />
				<span class="hidden sm:block">Previous</span>
			</a>
		</li>

		{
			pages.map((page) => (
				<li>
					<a
						href={getPageUrl(page)}
						aria-current={page === currentPage ? 'page' : undefined}
						class:list={[
							'inline-flex size-9 items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all',
							page === currentPage
								? 'border bg-background hover:bg-accent hover:text-accent-foreground dark:border-input dark:bg-input/30 dark:hover:bg-input/50'
								: 'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',
						]}
					>
						{page}
					</a>
				</li>
			))
		}

		{
			totalPages > 5 && (
				<li>
					<span
						aria-hidden
						class="flex size-9 items-center justify-center"
					>
						<Icon name="lucide:more-horizontal" class="size-4" />
						<span class="sr-only">More pages</span>
					</span>
				</li>
			)
		}

		<li>
			<a
				href={hasNext ? getPageUrl(currentPage + 1) : undefined}
				aria-label="Go to next page"
				class:list={[
					'inline-flex h-9 items-center justify-center gap-1 whitespace-nowrap rounded-md px-2.5 text-sm font-medium transition-all hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 sm:pr-2.5',
					!hasNext && 'pointer-events-none opacity-50',
				]}
			>
				<span class="hidden sm:block">Next</span>
				<Icon name="lucide:chevron-right" class="size-4" />
			</a>
		</li>
	</ul>
</nav>
